<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Kuis untuk Machi</title>
  <style>
    * { box-sizing: border-box; }
    body, html {
      margin: 0; padding: 0;
      font-family: Arial, sans-serif;
    }
    .bg {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-image: url('bg.png');
      background-size: cover;
      background-position: center;
      filter: blur(12px);
      z-index: -1;
    }
    .centered {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      padding: 20px;
      text-align: center;
      color: #ffc0cb;
      backdrop-filter: brightness(0.8) contrast(1.1);
      text-shadow: 1px 1px 2px white;
    }
    h1, h2 {
      color: #ffc0cb;
      text-shadow: 1px 1px 2px white;
    }
    button {
      margin: 10px;
      padding: 12px 24px;
      font-size: 1rem;
      background-color: rgba(255, 192, 203, 0.8);
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      width: 100%;
      max-width: 300px;
      font-weight: bold;
    }
    button:hover { background-color: rgba(255, 182, 193, 1); }
    .halaman { display: none; }
    #halaman1 { display: flex; }

    #puzzle {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      width: 90vw;
      max-width: 360px;
      aspect-ratio: 1 / 1;
      gap: 2px;
    }
    #puzzle img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border: 2px solid white;
      cursor: pointer;
      border-radius: 4px;
    }

    #akhir img {
      margin-top: 20px;
      width: 100%;
      max-width: 250px;
      height: auto;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0,0,0,0.3);
    }
    #akhir textarea {
      margin-top: 30px;
      border-radius: 8px;
      padding: 15px;
      font-size: 1rem;
      border: 1px solid pink;
      resize: vertical;
      width: 100%;
      height: 300px;
      line-height: 1.6;
      background-color: rgba(255, 255, 255, 0.85);
      color: #ff69b4;
    }
    @media (min-width: 768px) {
      #akhir img { max-width: 300px; }
      #akhir textarea { height: 400px; max-width: 700px; }
    }
    #popup {
      display: none;
      position: fixed;
      top: 30%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(255, 192, 203, 0.9);
      color: white;
      padding: 20px 30px;
      border-radius: 15px;
      font-size: 1.2rem;
      box-shadow: 0 0 20px rgba(255, 182, 193, 0.8);
      z-index: 9999;
      text-shadow: 1px 1px 2px #ff69b4;
    }
  </style>
</head>
<body>
  <div class="bg"></div>
  <audio id="bg-music" autoplay loop>
    <source src="lagu.mp3" type="audio/mpeg">
  </audio>
  <div id="popup">nah kan, lupa yee!</div>

  <div id="halaman1" class="centered halaman">
    <h1>Selamat Datang, Machi</h1>
    <button onclick="mulaiKuis()">Mulai</button>
  </div>

  <div id="halaman2" class="centered halaman">
    <h2>Dimana pertama kali kita ketemu?</h2>
    <button onclick="cekJawaban('A', 'B', 'halaman1', 'halaman3')">A. map relapse</button>
    <button onclick="cekJawaban('B', 'B', 'halaman1', 'halaman3')">B. map cellmate</button>
    <button onclick="cekJawaban('C', 'B', 'halaman1', 'halaman3')">C. map gunung</button>
  </div>

  <div id="halaman3" class="centered halaman">
    <h2>Siapa nama aku?</h2>
    <button onclick="cekJawaban('A', 'C', 'halaman1', 'halaman4')">A. Rizky</button>
    <button onclick="cekJawaban('B', 'C', 'halaman1', 'halaman4')">B. Huksy</button>
    <button onclick="cekJawaban('C', 'C', 'halaman1', 'halaman4')">C. Raihan</button>
  </div>

  <div id="halaman4" class="centered halaman">
    <h2>Di map mana kita ngobrol untuk kedua kalinya?</h2>
    <button onclick="cekJawaban('A', 'A', 'halaman1', 'halaman5', true)">A. map relapse</button>
    <button onclick="cekJawaban('B', 'A', 'halaman1', 'halaman5', true)">B. map gunung</button>
    <button onclick="cekJawaban('C', 'A', 'halaman1', 'halaman5', true)">C. map aneh pilihan kamu</button>
  </div>

  <div id="halaman5" class="centered halaman">
    <h2>Susun puzzle dulu yaa ðŸ’—</h2>
    <div id="puzzle"></div>
  </div>

  <div id="akhir" class="centered halaman">
    <h2>Kamu Lulus ðŸ’–</h2>
    <img src="8795131698_118766762413068_1753902553560.png" alt="Kamu Lulus">
    <h2>from Huksy ðŸ’Œ</h2>
    <textarea readonly>
Sedikit cerita. Awalnya aku lagi scroll tiktok, terus nemu konten tentang 1 Agustus. Karena aku penasaran, aku cari 1 Agustus ada apaan. Ternyata tren Girlfriend Day. Berhubung si Huksy ini masih sendiri aja, jadi web ini aku buatin buat kamu hehe.

Anyway Machi, makasih ya udah nemenin aku main Roblox. Dari yang awalnya aku pake avatar robot yang sering kamu hujat, sampai sekarang akhirnya glow up dikit lah ya, hahaha.

Makasih juga ya udah selalu nemenin call tiap malem. You've made some of my days feel a lot better without even trying. Kamu tuh orang nya asik, seru, lucu, dan selalu enak diajak ngobrol. That's why I enjoy chatting with you so much.

Ur mom really picked the perfect name. Machiko means sunflower, right? Totally makes sense karena kamu selalu cerah dan nyenengin buat orang di sekitar.

Tapi inget ya, if you're ever feeling down or overwhelmed, don't keep it all to yourself. Talk to someone you trust or me, if you want to :D.

Anyway, congrats on starting college! Hope everything goes smoothly and you stay happy and healthy. You got this, Machi!
    </textarea>
  </div>

  <script>
    const musik = document.getElementById("bg-music");
    const popup = document.getElementById("popup");

    function showPopup(text = 'nah kan, lupa yee!') {
      popup.innerText = text;
      popup.style.display = 'block';
      setTimeout(() => popup.style.display = 'none', 2000);
    }

    function mulaiKuis() {
      musik.play();
      keHalaman('halaman2');
    }

    function keHalaman(idTujuan) {
      document.querySelectorAll('.halaman').forEach(div => div.style.display = 'none');
      document.getElementById(idTujuan).style.display = 'flex';
    }

    function cekJawaban(pilihan, jawabanBenar, halamanSalah, halamanBenar, terakhir = false) {
      if (pilihan === jawabanBenar) {
        if (terakhir) showPopup('Alhamdullilah inget');
        keHalaman(halamanBenar);
      } else {
        showPopup();
        setTimeout(() => keHalaman(halamanSalah), 2000);
      }
    }

    // Puzzle logic (Drag & Drop + Tap-Tap)
    const puzzleContainer = document.getElementById('puzzle');
    const pieces = [...Array(9).keys()].map(i => `puzzle_pieces/piece${i}.png`);
    let currentOrder = [...pieces];
    let selectedIndex = null;

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    function renderPuzzle() {
      puzzleContainer.innerHTML = '';
      currentOrder.forEach((src, index) => {
        const img = document.createElement('img');
        img.src = src;
        img.dataset.index = index;

        img.draggable = true;
        img.addEventListener('dragstart', e => {
          e.dataTransfer.setData('text/plain', index);
        });
        img.addEventListener('dragover', e => e.preventDefault());
        img.addEventListener('drop', e => {
          const from = +e.dataTransfer.getData('text/plain');
          const to = +e.target.dataset.index;
          swapPieces(from, to);
          renderPuzzle();
          checkSolved();
        });

        img.addEventListener('click', () => {
          if (selectedIndex === null) {
            selectedIndex = index;
            highlight(index);
          } else {
            swapPieces(selectedIndex, index);
            selectedIndex = null;
            renderPuzzle();
            checkSolved();
          }
        });

        puzzleContainer.appendChild(img);
      });
    }

    function highlight(index) {
      const imgs = puzzleContainer.querySelectorAll('img');
      imgs.forEach(img => img.style.border = '2px solid white');
      imgs[index].style.border = '3px solid #ff69b4';
    }

    function swapPieces(i, j) {
      [currentOrder[i], currentOrder[j]] = [currentOrder[j], currentOrder[i]];
    }

    function checkSolved() {
      if (currentOrder.every((src, i) => src.endsWith(`piece${i}.png`))) {
        showPopup('Maba UPN pinter juga nyusun puzzle');
        setTimeout(() => keHalaman('akhir'), 1500);
      }
    }

    currentOrder = shuffle(currentOrder);
    renderPuzzle();
  </script>
</body>
</html>
